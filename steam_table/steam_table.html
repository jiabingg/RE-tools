<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Saturated Steam Property Calculator (Imperial Units)</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Custom styles for better visual appeal */
        .input-group:focus-within label {
            color: #3b82f6; /* blue-500 */
        }
        .result-value {
            transition: all 0.3s ease-in-out;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-4xl mx-auto bg-white rounded-xl shadow-lg p-6 md:p-8">

        <header class="mb-6 text-center">
            <h1 class="text-3xl font-bold text-gray-800">Saturated Steam Property Calculator (Imperial Units)</h1>
            <p class="text-gray-500 mt-2">Enter either Temperature or Pressure to find the corresponding steam properties. Values are interpolated if not found in the table.</p>
        </header>

        <!-- Input Section -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
            <div class="input-group">
                <label for="temperature" class="block text-sm font-medium text-gray-700 mb-1">Temperature (°F)</label>
                <input type="number" id="temperature" placeholder="e.g., 300" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition">
            </div>
            <div class="input-group">
                <label for="pressure" class="block text-sm font-medium text-gray-700 mb-1">Pressure (psia)</label>
                <input type="number" id="pressure" placeholder="e.g., 67" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition">
            </div>
        </div>
        
        <div class="flex justify-center mb-6">
             <button id="resetButton" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-6 rounded-lg transition duration-300 ease-in-out transform hover:scale-105">Reset</button>
        </div>


        <!-- Results Section -->
        <div id="results-container" class="border-t border-gray-200 pt-6">
            <h2 class="text-xl font-semibold text-gray-700 mb-4 flex items-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2 text-blue-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>
                Results
            </h2>
            <div id="status" class="text-center text-gray-500 italic py-4">Enter a value to begin.</div>
            <div id="results-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 hidden">
                <!-- Results will be dynamically inserted here -->
            </div>
        </div>
    </div>

    <script>
        // --- DATA (Imperial Units) ---
        // Saturated steam table data in Imperial units.
        const csvData = `Temperature (°F),Pressure (psia),Specific Volume Liquid (ft³/lb),Specific Volume Vapor (ft³/lb),Specific Enthalpy Liquid (Btu/lb),Specific Enthalpy Evaporation (Btu/lb),Specific Enthalpy Vapor (Btu/lb),Specific Entropy Liquid (Btu/lb·R),Specific Entropy Vapor (Btu/lb·R)
32.02,0.0887,0.01602,3302.4,0.0,1075.2,1075.2,0.0000,2.1873
40,0.1217,0.01602,2444.0,8.02,1070.7,1078.7,0.0162,2.1648
50,0.1781,0.01602,1703.2,18.06,1065.2,1083.3,0.0361,2.1287
60,0.2563,0.01604,1206.7,28.08,1059.5,1087.6,0.0556,2.0945
80,0.5073,0.01608,632.7,48.09,1048.0,1096.1,0.0933,2.0355
100,0.9503,0.01613,350.0,68.05,1036.3,1104.4,0.1296,1.9818
120,1.695,0.01620,203.1,88.00,1024.5,1112.5,0.1647,1.9327
140,2.893,0.01630,122.9,107.96,1012.6,1120.6,0.1985,1.8876
160,4.741,0.01640,77.2,127.95,1000.5,1128.5,0.2313,1.8460
180,7.515,0.01651,50.2,147.96,988.4,1136.4,0.2630,1.8075
200,11.53,0.01663,33.6,168.03,976.0,1144.0,0.2938,1.7716
212,14.70,0.01672,26.8,180.17,970.3,1150.5,0.3121,1.7566
220,17.19,0.01677,23.1,188.16,965.2,1153.4,0.3239,1.7441
240,24.97,0.01692,16.3,208.46,952.1,1160.6,0.3540,1.7130
260,35.43,0.01708,11.7,228.8,938.6,1167.4,0.3831,1.6841
280,49.20,0.01725,8.51,249.2,924.9,1174.1,0.4112,1.6572
300,67.01,0.01744,6.20,269.7,910.8,1180.5,0.4385,1.6321
320,89.66,0.01764,4.64,290.4,896.2,1186.6,0.4651,1.6084
350,134.6,0.01799,3.16,321.8,875.0,1196.8,0.5034,1.5746
400,247.1,0.01864,1.86,375.1,826.8,1201.9,0.5665,1.5274
450,422.3,0.01944,1.10,430.1,770.4,1200.5,0.6233,1.4795
500,680.1,0.02043,0.68,487.8,702.5,1190.3,0.6766,1.4294
550,1045,0.02167,0.44,549.3,621.1,1170.4,0.7285,1.3752
600,1541,0.0234,0.28,616.7,520.8,1137.5,0.7820,1.3134
650,2207,0.0261,0.18,694.0,388.6,1082.6,0.8427,1.2359
700,3090,0.0328,0.09,800.0,171.4,971.4,0.9298,1.1171
705.4,3206.2,0.0503,0.0503,908.8,0.0,908.8,1.0601,1.0601`;

        // --- SCRIPT LOGIC ---
        
        let steamData = [];
        let headers = [];

        const tempInput = document.getElementById('temperature');
        const pressInput = document.getElementById('pressure');
        const resetButton = document.getElementById('resetButton');
        const resultsGrid = document.getElementById('results-grid');
        const statusDiv = document.getElementById('status');
        
        /**
         * Parses the raw CSV string into an array of objects.
         */
        function parseCSV() {
            const lines = csvData.trim().split('\n');
            headers = lines[0].split(',').map(h => h.trim());
            
            steamData = lines.slice(1).map(line => {
                const values = line.split(',');
                const entry = {};
                headers.forEach((header, index) => {
                    const value = parseFloat(values[index]);
                    entry[header] = isNaN(value) ? values[index] : value;
                });
                return entry;
            });
        }

        /**
         * Linear interpolation function.
         * y = y1 + (x - x1) * (y2 - y1) / (x2 - x1)
         */
        function interpolate(x, x1, y1, x2, y2) {
            if (x2 === x1) return y1; // Avoid division by zero
            return y1 + (x - x1) * (y2 - y1) / (x2 - x1);
        }

        /**
         * Displays the results in the grid.
         * @param {object} dataObject - The object containing property values.
         * @param {string} status - A message indicating how the result was obtained (e.g., "Exact Match").
         */
        function displayResults(dataObject, status) {
            resultsGrid.innerHTML = ''; // Clear previous results
            statusDiv.textContent = status;
            statusDiv.classList.remove('text-red-500');

            // Define units for each property
            const units = {
                'Temperature (°F)': '°F',
                'Pressure (psia)': 'psia',
                'Specific Volume Liquid (ft³/lb)': 'ft³/lb',
                'Specific Volume Vapor (ft³/lb)': 'ft³/lb',
                'Specific Enthalpy Liquid (Btu/lb)': 'Btu/lb',
                'Specific Enthalpy Evaporation (Btu/lb)': 'Btu/lb',
                'Specific Enthalpy Vapor (Btu/lb)': 'Btu/lb',
                'Specific Entropy Liquid (Btu/lb·R)': 'Btu/lb·R',
                'Specific Entropy Vapor (Btu/lb·R)': 'Btu/lb·R',
            };

            Object.entries(dataObject).forEach(([key, value]) => {
                const valueStr = typeof value === 'number' ? value.toFixed(4) : value;
                const unit = units[key] || '';
                
                const resultCard = `
                    <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                        <p class="text-sm text-gray-600">${key.replace(/\s\(.*\)/, '')}</p>
                        <p class="text-lg font-semibold text-blue-600 result-value">${valueStr} <span class="text-sm font-normal text-gray-500">${unit}</span></p>
                    </div>
                `;
                resultsGrid.innerHTML += resultCard;
            });

            resultsGrid.classList.remove('hidden');
        }

        /**
         * Displays an error or info message.
         * @param {string} message - The message to display.
         */
        function showMessage(message) {
            resultsGrid.classList.add('hidden');
            statusDiv.textContent = message;
            statusDiv.classList.add('text-red-500');
        }

        /**
         * The core calculation logic. Finds or interpolates properties based on user input.
         * @param {number} value - The input temperature or pressure.
         * @param {string} type - 'temp' or 'pressure'.
         */
        function calculateProperties(value, type) {
            const key = type === 'temp' ? headers[0] /* Temperature */ : headers[1] /* Pressure */;
            
            // Check if input is within the table's range
            const minVal = steamData[0][key];
            const maxVal = steamData[steamData.length - 1][key];
            if (value < minVal || value > maxVal) {
                showMessage(`Input value is out of range. Please enter a ${type === 'temp' ? 'temperature' : 'pressure'} between ${minVal} and ${maxVal}.`);
                return;
            }

            // Find an exact match
            const exactMatch = steamData.find(row => row[key] === value);
            if (exactMatch) {
                displayResults(exactMatch, `Exact match found for ${value} ${key.includes('Temp') ? '°F' : 'psia'}`);
                return;
            }
            
            // If no exact match, find points for interpolation
            let lowerBound, upperBound;
            for (let i = 0; i < steamData.length - 1; i++) {
                if (value > steamData[i][key] && value < steamData[i+1][key]) {
                    lowerBound = steamData[i];
                    upperBound = steamData[i+1];
                    break;
                }
            }

            if (!lowerBound || !upperBound) {
                 showMessage('Could not find suitable data points for interpolation.');
                 return;
            }

            // Perform interpolation for all properties
            const interpolatedResult = {};
            headers.forEach(h => {
                if (typeof lowerBound[h] === 'number' && typeof upperBound[h] === 'number') {
                     interpolatedResult[h] = interpolate(value, lowerBound[key], lowerBound[h], upperBound[key], upperBound[h]);
                } else {
                     interpolatedResult[h] = 'N/A'; // Handle non-numeric data if any
                }
            });
            
            // Ensure the input value is exact in the result
            interpolatedResult[key] = value; 

            displayResults(interpolatedResult, `Interpolated result for ${value} ${key.includes('Temp') ? '°F' : 'psia'}`);
        }
        
        /**
         * Resets the entire calculator to its initial state.
         */
        function resetCalculator() {
            tempInput.value = '';
            pressInput.value = '';
            resultsGrid.classList.add('hidden');
            statusDiv.textContent = 'Enter a value to begin.';
            statusDiv.classList.remove('text-red-500');
        }

        // --- EVENT LISTENERS ---

        tempInput.addEventListener('input', (e) => {
            pressInput.value = ''; // Clear other input
            const temp = parseFloat(e.target.value);
            if (!isNaN(temp)) {
                calculateProperties(temp, 'temp');
            } else {
                resetCalculator();
            }
        });

        pressInput.addEventListener('input', (e) => {
            tempInput.value = ''; // Clear other input
            const press = parseFloat(e.target.value);
            if (!isNaN(press)) {
                calculateProperties(press, 'pressure');
            } else {
                resetCalculator();
            }
        });
        
        resetButton.addEventListener('click', resetCalculator);

        // --- INITIALIZATION ---
        // Parse the data when the script loads.
        parseCSV();

    </script>
</body>
</html>
